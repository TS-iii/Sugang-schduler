{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\ReactProject\\\\sugang-scheduler\\\\sugang-frontend\\\\src\\\\containers\\\\graph\\\\GraphContainers.js\";\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport Graphy from '../../component/graph/Graphy';\nimport { mainTree, lookschedule } from '../../lib/tree/tree1'; // 안겹친다는 가정이 필요\n// 안겹치고 이 함수를 사용하면 dst 시간표에 src가 추가됨. \n// 시간표와, 시간표에 넣을 과목을 dst, src 차례로 주면됨\n//const insertTable=function(dst,src)\n\nconst GraphContainer = () => {\n  //TdrawList랑 addlist id는 배열의 인덱스랑 같음 \n  const [TdrawList, setTdrawList] = useState([]); // 현재 신청된 목록들  (/graph 상단 목록에 영향)\n  //{data: , id: }\n\n  const [addlist, setaddlist] = useState([]); // 현재 추가 가능한 목록들 (/graph 하단 목록에 영향 )\n  // {data: id: }\n\n  const [makingdrawList, setmakingdrawList] = useState([]); // 현재 신청된 목록의 시간표 좌표 구현\n\n  const [allList, setallList] = useState([]);\n  const [nownum, setnownum] = useState(0);\n  const [click, setclick] = useState([]);\n  const [maindata, setmaindata] = useState([]);\n  const [subdata, setsubdata] = useState([]);\n  const [world, setworld] = useState(true); // const [first,setfirst]=useState(true);\n  // 대안 루트 (id)는 실패했을 경우 \n\n  const NextRoot = id => {\n    let bb = [];\n    setworld(prev => false);\n    console.log(\"setworld\");\n    console.log(world);\n    let tf = false;\n    let data = TdrawList.find(c => c.id === id);\n\n    if (click.length === 0) {\n      setmaindata(TdrawList.filter(c => c.id !== id));\n      bb.push(data);\n      setclick(bb);\n      tf = false;\n    } else {\n      for (let i = 0; i < click.length; i++) {\n        if (click[i].id !== id) {\n          bb.push(click[i]);\n        }\n      } // id가 있었음\n\n\n      if (bb.length !== click.length) {\n        tf = true;\n        setclick(bb);\n        setmaindata(...maindata, data);\n      } //id가 없었음 \n      else {\n          tf = false;\n          bb.push(data);\n          setclick(bb);\n          setmaindata(maindata.filter(c => c.id !== id));\n        }\n    }\n\n    let kk = [];\n    if (tf === false) kk = TdrawList.filter(c => c.id !== id);else kk = TdrawList;\n    console.log(\"시작\");\n    const fflist = mainTree(Maintable, kk, bb);\n    let list = [];\n    if (fflist.length === 0) list.push(kk);else {\n      for (let i = 0; i < fflist.length; i++) {\n        list.push(fflist[i].concat(kk));\n      }\n    }\n    setnownum(0);\n    setallList(list);\n  }; // 현재 시간표에서 삭제 버튼 클릭시 함수 호출 \n\n\n  const Delete = id => {\n    const aa = TdrawList.filter(e => e.id !== id); // 일단 삭제할 id찾아서 지운배열을 aa에 전달\n\n    setTdrawList(aa); // 그리고 TdrawList에 적용\n\n    let addtemp = []; // 추가가능한 과목들 배열 만듬\n    // 여기서부터는 1,2,3순위 입력된 모든 과목들중에 aa에 있는 과목을 제외하고 추가로 신청 가능한 과목이 있는지 살펴봄.\n\n    for (let j = 0; j < type1.length; j++) {\n      // type1부터 살펴봄\n      let i = 0;\n\n      for (i = 0; i < aa.length; i++) // aa는 현재 선택된 시간표 \n      {\n        if (aa[i].classname === type1[j].classname) // 같은 과목은 동시 수강 못하므로 \n          break;\n        if (!lookschedule(aa[i].classtime, type1[j].classtime)) break; // 시간표가 중복되면 동시 수강 못하므로 \n      }\n\n      if (i === aa.length) {\n        // 최종적으로 수강 가능한 과목이면\n        addtemp.push(type1[j]); // addtemp에 넣음.\n      }\n    }\n\n    for (let j = 0; j < type2.length; j++) {\n      let i = 0;\n\n      for (i = 0; i < aa.length; i++) {\n        if (aa[i].classname === type2[j].classname) break;\n        if (!lookschedule(aa[i].classtime, type2[j].classtime)) break;\n      }\n\n      if (i === aa.length) {\n        addtemp.push(type2[j]);\n      }\n    }\n\n    for (let j = 0; j < type3.length; j++) {\n      let i = 0;\n\n      for (i = 0; i < aa.length; i++) {\n        if (aa[i].classname === type3[j].classname) break;\n        if (!lookschedule(aa[i].classtime, type3[j].classtime)) break;\n      }\n\n      if (i === aa.length) {\n        addtemp.push(type3[j]);\n      }\n    }\n\n    setaddlist(addtemp);\n  };\n\n  const Add = id => {\n    let aa = [];\n    let data = addlist.find(c => c.id === id);\n    if (TdrawList.length !== 0) // 과목 개수가 0이 아니면\n      aa = [...TdrawList, data]; // 기존 과목배열에 신규 과목 추가 \n    else aa.push(data); // 현재 과목 개수가 0이면 그냥 추가 \n\n    let bb = [];\n\n    for (let i = 0; i < addlist.length; i++) {\n      if (addlist[i].id !== id) {\n        if (addlist[i].classname !== data.classname) {\n          if (lookschedule(addlist[i].classtime, data.classtime)) {\n            bb.push(addlist[i]);\n          }\n        }\n      }\n    }\n\n    setaddlist(bb);\n    setTdrawList(aa);\n  };\n\n  const {\n    type1,\n    type2,\n    type3\n  } = useSelector(({\n    write\n  }) => ({\n    type1: write.type1,\n    type2: write.type2,\n    type3: write.type3\n  }));\n  const Maintable = {\n    type1,\n    type2,\n    type3\n  };\n  useEffect(() => makingDrawList(), [TdrawList]);\n  useEffect(() => finalprint(), [allList]); // 배열로 시간표 리스트만 넘기면됨 \n  // 얘는 TdrawList를 살펴보고 과목당 시간을 적절히 출력할 수 있게 숫자로 바꿔줌\n\n  const makingDrawList = useCallback(() => {\n    let makingTable = [];\n\n    for (let i = 0; i < TdrawList.length; i++) {\n      // 한 과목씩 살펴봄\n      for (let j = 0; j < TdrawList[i].classtime.keyword.length; j++) {\n        // 한 과목의 요일수\n        let day;\n\n        switch (TdrawList[i].classtime.keyword[j]) {\n          case 't1':\n            day = 5;\n            break;\n\n          case 't2':\n            day = 24;\n            break;\n\n          case 't3':\n            day = 43;\n            break;\n\n          case 't4':\n            day = 62;\n            break;\n\n          case 't5':\n            day = 81;\n            break;\n\n          default:\n            break;\n        }\n\n        let dayarr = TdrawList[i].classtime[TdrawList[i].classtime.keyword[j]]; // 요일 배열\n\n        let timeleng = dayarr.length * 3.5;\n        let time = 9 + (dayarr[0] - 2) * 3.5;\n        makingTable.push({\n          x: day,\n          y: time,\n          ycolor: timeleng,\n          color: \"#CEF6F5\",\n          text: TdrawList[i].classname\n        });\n      }\n    }\n\n    console.log(makingTable);\n    setmakingdrawList(makingTable);\n  }, [TdrawList]);\n\n  const Calculate = () => {\n    const fflist = mainTree(Maintable, [], []);\n    setnownum(0);\n    setworld(true);\n    setallList(fflist);\n  };\n\n  const finalprint = () => {\n    let kkk = [];\n\n    if (allList.length !== 0) {\n      for (let i = 0; i < allList[nownum].length; i++) {\n        let tt = allList[nownum][i];\n        kkk.push(tt);\n\n        if (world === false) {\n          if (!maindata.find(c => c.id === allList[nownum][i].id)) {\n            setsubdata(allList[nownum][i]);\n          }\n        }\n      }\n\n      for (let i = 0; i < click.length; i++) {\n        kkk.push(click[i]);\n      }\n\n      if (world === true) {\n        setmaindata(kkk);\n      }\n\n      setTdrawList(kkk);\n    }\n  };\n\n  const next = () => {\n    if (allList.length - 1 === nownum) {\n      setnownum(0);\n    } else {\n      setnownum(nownum + 1);\n    }\n\n    finalprint();\n  };\n\n  const previous = () => {\n    if (nownum > 0) {\n      setnownum(nownum - 1);\n      finalprint();\n    }\n  };\n\n  return React.createElement(Graphy, {\n    TdrawList: TdrawList,\n    Delete: Delete,\n    makingdrawList: makingdrawList,\n    Calculate: Calculate,\n    next: next,\n    previous: previous,\n    Add: Add,\n    addlist: addlist,\n    NextRoot: NextRoot,\n    click: click,\n    maindata: maindata,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434\n    },\n    __self: this\n  });\n};\n\nexport default GraphContainer;","map":{"version":3,"sources":["C:/Users/user/Desktop/ReactProject/sugang-scheduler/sugang-frontend/src/containers/graph/GraphContainers.js"],"names":["React","useState","useCallback","useEffect","useSelector","Graphy","mainTree","lookschedule","GraphContainer","TdrawList","setTdrawList","addlist","setaddlist","makingdrawList","setmakingdrawList","allList","setallList","nownum","setnownum","click","setclick","maindata","setmaindata","subdata","setsubdata","world","setworld","NextRoot","id","bb","prev","console","log","tf","data","find","c","length","filter","push","i","kk","fflist","Maintable","list","concat","Delete","aa","e","addtemp","j","type1","classname","classtime","type2","type3","Add","write","makingDrawList","finalprint","makingTable","keyword","day","dayarr","timeleng","time","x","y","ycolor","color","text","Calculate","kkk","tt","next","previous"],"mappings":"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","sourcesContent":["\r\nimport React , {useState,useCallback,useEffect} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport Graphy from '../../component/graph/Graphy';\r\n\r\nimport  { mainTree,lookschedule} from '../../lib/tree/tree1';\r\n\r\n\r\n\r\n// 안겹친다는 가정이 필요\r\n// 안겹치고 이 함수를 사용하면 dst 시간표에 src가 추가됨. \r\n// 시간표와, 시간표에 넣을 과목을 dst, src 차례로 주면됨\r\n//const insertTable=function(dst,src)\r\n\r\n\r\n\r\nconst GraphContainer=()=>{\r\n\r\n\r\n\r\n    //TdrawList랑 addlist id는 배열의 인덱스랑 같음 \r\n    const [TdrawList,setTdrawList]=useState([]);    // 현재 신청된 목록들  (/graph 상단 목록에 영향)\r\n    //{data: , id: }\r\n    const [addlist,setaddlist]=useState([]);    // 현재 추가 가능한 목록들 (/graph 하단 목록에 영향 )\r\n    // {data: id: }\r\n\r\n    const [makingdrawList,setmakingdrawList]=useState([]); // 현재 신청된 목록의 시간표 좌표 구현\r\n\r\n    const [allList,setallList]=useState([]);    \r\n\r\n    const [nownum,setnownum]=useState(0);   \r\n\r\n\r\n    const [click,setclick]=useState([]);\r\n    const [maindata,setmaindata]=useState([]);\r\n    const [subdata,setsubdata]=useState([]);\r\n\r\n    const [world,setworld]=useState(true);\r\n\r\n    // const [first,setfirst]=useState(true);\r\n\r\n    \r\n    \r\n\r\n    // 대안 루트 (id)는 실패했을 경우 \r\n    const NextRoot=(id)=>{\r\n        \r\n        let bb=[];\r\n\r\n        setworld(prev=>false);\r\n        console.log(\"setworld\");\r\n        console.log(world);\r\n        \r\n        let tf=false;\r\n\r\n        let data=TdrawList.find(c=>c.id===id);\r\n\r\n        if(click.length===0)\r\n            {\r\n                setmaindata(TdrawList.filter(c=>c.id!==id));\r\n                bb.push(data);\r\n                setclick(bb);\r\n                tf=false;\r\n            }\r\n\r\n        else{\r\n\r\n        for(let i=0;i<click.length;i++){\r\n\r\n            \r\n            if(click[i].id!==id)\r\n                {\r\n                   bb.push(click[i]);\r\n\r\n                }\r\n            \r\n\r\n        }\r\n        \r\n        \r\n            // id가 있었음\r\n        if(bb.length!==click.length){\r\n                tf=true;\r\n                setclick(bb);        \r\n                setmaindata(...maindata,data);\r\n            \r\n        }\r\n\r\n        //id가 없었음 \r\n        else{\r\n            tf=false;\r\n            bb.push(data);\r\n\r\n            setclick(bb);\r\n            setmaindata(maindata.filter(c=>c.id!==id));\r\n        }\r\n\r\n         }\r\n\r\n\r\n         let kk=[];\r\n         if(tf===false)\r\n            kk=TdrawList.filter(c=>c.id!==id);\r\n        else \r\n            kk=TdrawList;\r\n\r\n       \r\n         \r\n        \r\n         console.log(\"시작\");\r\n       \r\n         \r\n        const fflist=mainTree(Maintable,kk,bb);\r\n         \r\n        let list=[];\r\n\r\n        if(fflist.length===0)\r\n         list.push(kk);\r\n\r\n        else{\r\n        for(let i=0;i<fflist.length;i++){\r\n\r\n            list.push(fflist[i].concat(kk));\r\n\r\n        \r\n        }\r\n        }\r\n\r\n        setnownum(0);\r\n        setallList(list);\r\n        \r\n\r\n    };\r\n\r\n\r\n\r\n    // 현재 시간표에서 삭제 버튼 클릭시 함수 호출 \r\n    const Delete=(id)=>{\r\n\r\n       const aa=TdrawList.filter(e=>(e.id!==id));  // 일단 삭제할 id찾아서 지운배열을 aa에 전달\r\n\r\n\r\n       setTdrawList(aa);    // 그리고 TdrawList에 적용\r\n\r\n       let addtemp=[];      // 추가가능한 과목들 배열 만듬\r\n    \r\n      \r\n\r\n       // 여기서부터는 1,2,3순위 입력된 모든 과목들중에 aa에 있는 과목을 제외하고 추가로 신청 가능한 과목이 있는지 살펴봄.\r\n       for(let j=0;j<type1.length;j++){ // type1부터 살펴봄\r\n\r\n        let i=0;\r\n        for(i=0;i<aa.length;i++)    // aa는 현재 선택된 시간표 \r\n        {\r\n        if(aa[i].classname===type1[j].classname)   // 같은 과목은 동시 수강 못하므로 \r\n                    break;\r\n        if(!lookschedule(aa[i].classtime,type1[j].classtime))\r\n                break;  // 시간표가 중복되면 동시 수강 못하므로 \r\n                \r\n\r\n\r\n        }\r\n\r\n        if(i===aa.length){  // 최종적으로 수강 가능한 과목이면\r\n            addtemp.push(type1[j]);    // addtemp에 넣음.\r\n          \r\n        }\r\n\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n       \r\n        for(let j=0;j<type2.length;j++){\r\n\r\n            let i=0;\r\n            for(i=0;i<aa.length;i++)\r\n            {\r\n            if(aa[i].classname===type2[j].classname)\r\n                        break;\r\n            if(!lookschedule(aa[i].classtime,type2[j].classtime))\r\n                    break;\r\n                    \r\n    \r\n    \r\n            }\r\n    \r\n            if(i===aa.length){\r\n                addtemp.push(type2[j]);\r\n             \r\n    \r\n            }\r\n    \r\n    \r\n    \r\n            }\r\n\r\n\r\n            for(let j=0;j<type3.length;j++){\r\n\r\n                let i=0;\r\n                for(i=0;i<aa.length;i++)\r\n                {\r\n                if(aa[i].classname===type3[j].classname)\r\n                            break;\r\n                if(!lookschedule(aa[i].classtime,type3[j].classtime))\r\n                        break;\r\n                        \r\n        \r\n        \r\n                }\r\n        \r\n                if(i===aa.length){\r\n                    addtemp.push(type3[j]);\r\n                    \r\n        \r\n                }\r\n        \r\n        \r\n        \r\n                }\r\n    \r\n        setaddlist(addtemp);\r\n          \r\n      };\r\n\r\n      \r\n      const Add=(id)=>{\r\n\r\n        \r\n\r\n        let aa=[];\r\n\r\n        let data=addlist.find(c=>c.id===id);\r\n\r\n        if(TdrawList.length!==0)    // 과목 개수가 0이 아니면\r\n             aa=[...TdrawList,data]; // 기존 과목배열에 신규 과목 추가 \r\n        else\r\n            aa.push(data);    // 현재 과목 개수가 0이면 그냥 추가 \r\n\r\n\r\n\r\n     \r\n        let bb=[];\r\n     \r\n      \r\n        for(let i=0;i<addlist.length;i++){\r\n            if(addlist[i].id!==id){\r\n                if(addlist[i].classname!==data.classname){\r\n                    if(lookschedule(addlist[i].classtime,data.classtime))\r\n                        {\r\n                            bb.push(addlist[i]);\r\n                         \r\n                        }\r\n\r\n                }\r\n          \r\n            }\r\n\r\n\r\n        }\r\n      \r\n        setaddlist(bb);\r\n        setTdrawList(aa);\r\n\r\n\r\n      };\r\n    \r\n      \r\n      \r\n\r\n    const {type1,type2,type3}=useSelector(({write})=>({\r\n\r\n       type1:write.type1,\r\n       type2:write.type2,\r\n       type3:write.type3,\r\n    }\r\n    )); \r\n\r\n    const Maintable={\r\n        type1,type2,type3\r\n    };\r\n    \r\n\r\n\r\nuseEffect(()=>makingDrawList(),[TdrawList]);\r\nuseEffect(()=>finalprint(),[allList]);\r\n\r\n    // 배열로 시간표 리스트만 넘기면됨 \r\n\r\n    // 얘는 TdrawList를 살펴보고 과목당 시간을 적절히 출력할 수 있게 숫자로 바꿔줌\r\n    const makingDrawList=useCallback(()=>{\r\n\r\n        let makingTable=[];\r\n\r\n        for(let i=0;i<TdrawList.length;i++){  // 한 과목씩 살펴봄\r\n\r\n            for(let j=0;j<TdrawList[i].classtime.keyword.length;j++){  // 한 과목의 요일수\r\n                \r\n                let day;\r\n\r\n                switch(TdrawList[i].classtime.keyword[j]){\r\n                    case 't1': day=5; break;\r\n                    case 't2': day=24; break;\r\n                    case 't3': day=43; break;\r\n                    case 't4': day=62; break;\r\n                    case 't5': day=81; break;\r\n                    default: break;\r\n\r\n                }\r\n\r\n              \r\n\r\n              let dayarr=  TdrawList[i].classtime[TdrawList[i].classtime.keyword[j]]; // 요일 배열\r\n                \r\n              let timeleng=dayarr.length * 3.5;\r\n              let time=9+((dayarr[0]-2)*3.5);\r\n\r\n                makingTable.push({x:day,y:time,ycolor:timeleng,color:\"#CEF6F5\",text:TdrawList[i].classname});\r\n            \r\n            }\r\n\r\n\r\n        }\r\n        \r\n        console.log(makingTable);\r\n        setmakingdrawList(makingTable);\r\n\r\n\r\n    },[TdrawList]);\r\n\r\n    \r\n\r\n    const Calculate=()=>{\r\n\r\n        const fflist=mainTree(Maintable,[],[]);\r\n\r\n        setnownum(0);\r\n        setworld(true);\r\n        setallList(fflist);\r\n        \r\n\r\n    };\r\n\r\n    \r\n\r\n    const finalprint=()=>{\r\n\r\n        let kkk=[];\r\n        if(allList.length!==0){\r\n\r\n            \r\n        for(let i=0;i<allList[nownum].length;i++){\r\n\r\n            let tt=allList[nownum][i];\r\n\r\n            kkk.push(tt);\r\n\r\n\r\n\r\n            if(world===false){\r\n\r\n                if(!maindata.find(c=>c.id===allList[nownum][i].id)){\r\n\r\n                    setsubdata(allList[nownum][i]);\r\n\r\n                }\r\n                \r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n        for(let i=0;i<click.length;i++){\r\n            kkk.push(click[i]);\r\n        }\r\n\r\n        if(world===true){\r\n\r\n            setmaindata(kkk);\r\n\r\n        }\r\n        \r\n        \r\n\r\n        setTdrawList(kkk);\r\n\r\n    }\r\n\r\n    };\r\n    \r\n\r\n    const next=()=>{\r\n\r\n        if(allList.length -1 === nownum  ){\r\n\r\n            setnownum(0);\r\n\r\n           \r\n        }\r\n\r\n        else {\r\n\r\n            setnownum(nownum+1);\r\n            \r\n\r\n        }\r\n finalprint();\r\n\r\n    };\r\n\r\n    const previous=()=>{\r\n\r\n        if(nownum>0){\r\n\r\n            setnownum(nownum-1);\r\n            finalprint();\r\n\r\n        }\r\n\r\n        \r\n\r\n    };\r\n\r\n     \r\n\r\n\r\n    return (\r\n        <Graphy \r\n            TdrawList={TdrawList}\r\n            Delete={Delete}\r\n            makingdrawList={makingdrawList}\r\n            Calculate={Calculate}\r\n            next={next}\r\n            previous={previous}\r\n            Add={Add}\r\n            addlist={addlist}\r\n            NextRoot={NextRoot}\r\n            click={click}\r\n            maindata={maindata}\r\n           \r\n            >\r\n\r\n            </Graphy>\r\n    );\r\n\r\n\r\n};\r\n\r\n\r\nexport default GraphContainer;"]},"metadata":{},"sourceType":"module"}