{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\ReactProject\\\\sugang-scheduler\\\\sugang-frontend\\\\src\\\\containers\\\\graph\\\\GraphContainer.js\";\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport Graph from '../../component/graph/Graph';\nimport { register } from '../../modules/write';\nimport Node, { lookschedule, insertTable, composeTree, search } from '../../lib/tree/tree';\nimport { tsConstructorType } from '../../../../../../../AppData/Local/Microsoft/TypeScript/3.7/node_modules/@babel/types/lib/index'; // 안겹친다는 가정이 필요\n// 안겹치고 이 함수를 사용하면 dst 시간표에 src가 추가됨. \n// 시간표와, 시간표에 넣을 과목을 dst, src 차례로 주면됨\n//const insertTable=function(dst,src)\n\nclass mNode {\n  constructor(list) {\n    this.children = [];\n    this.classlist = list;\n  }\n\n  insert(list) {\n    let node = new mNode(list);\n    this.children[this.children.length] = node;\n  }\n\n}\n\n;\n\nconst GraphContainer = () => {\n  //TdrawList랑 addlist id는 배열의 인덱스랑 같음 \n  const [TdrawList, setTdrawList] = useState([]); // 현재 신청된 목록들  (/graph 상단 목록에 영향)\n  //{data: , id: }\n\n  const [addlist, setaddlist] = useState([]); // 현재 추가 가능한 목록들 (/graph 하단 목록에 영향 )\n  // {data: id: }\n\n  const [makingdrawList, setmakingdrawList] = useState([]); // 현재 신청된 목록의 시간표 좌표 구현\n\n  const [allList, setallList] = useState([]);\n  const [nownum, setnownum] = useState(0); // 대안 루트 (id)는 실패했을 경우 \n\n  const NextRoot = id => {}; // 현재 시간표에서 삭제 버튼 클릭시 함수 호출 \n\n\n  const Delete = id => {\n    const aa = TdrawList.filter(e => e.id !== id); // 일단 삭제할 id찾아서 지운배열을 aa에 전달\n    // id는 0부터 시작~ 시간표 개수-1만큼 \n\n    for (let i = 0; i < aa.length; i++) {\n      aa[i].id = i;\n    } // id 다시 수정\n\n\n    setTdrawList(aa); // 그리고 TdrawList에 적용\n\n    let addtemp = []; // 추가가능한 과목들 배열 만듬\n\n    let addid = 0; // 추가가능한 과목의 id도 각각 부여\n    // 여기서부터는 1,2,3순위 입력된 모든 과목들중에 aa에 있는 과목을 제외하고 추가로 신청 가능한 과목이 있는지 살펴봄.\n\n    for (let j = 0; j < type1.length; j++) {\n      // type1부터 살펴봄\n      let i = 0;\n\n      for (i = 0; i < aa.length; i++) // aa는 현재 선택된 시간표 \n      {\n        if (aa[i].data.classname === type1[j].classname) // 같은 과목은 동시 수강 못하므로 \n          break;\n        if (!lookschedule(aa[i].data.classtime, type1[j].classtime)) break; // 시간표가 중복되면 동시 수강 못하므로 \n      }\n\n      if (i === aa.length) {\n        // 최종적으로 수강 가능한 과목이면\n        addtemp.push({\n          data: type1[j],\n          id: addid\n        }); // addtemp에 넣음.\n\n        addid++;\n      }\n    }\n\n    for (let j = 0; j < type2.length; j++) {\n      let i = 0;\n\n      for (i = 0; i < aa.length; i++) {\n        if (aa[i].data.classname === type2[j].classname) break;\n        if (!lookschedule(aa[i].data.classtime, type2[j].classtime)) break;\n      }\n\n      if (i === aa.length) {\n        addtemp.push({\n          data: type2[j],\n          id: addid\n        });\n        addid++;\n      }\n    }\n\n    for (let j = 0; j < type3.length; j++) {\n      let i = 0;\n\n      for (i = 0; i < aa.length; i++) {\n        if (aa[i].data.classname === type3[j].classname) break;\n        if (!lookschedule(aa[i].data.classtime, type3[j].classtime)) break;\n      }\n\n      if (i === aa.length) {\n        addtemp.push({\n          data: type3[j],\n          id: addid\n        });\n        addid++;\n      }\n    }\n\n    setaddlist(addtemp);\n  };\n\n  const Add = id => {\n    let nid = TdrawList.length; // 현재 신청된 시간표의 과목 개수\n\n    let aa = [];\n    if (TdrawList.length !== 0) // 과목 개수가 0이 아니면\n      aa = [...TdrawList, {\n        id: nid,\n        data: addlist[id].data\n      }]; // 기존 과목배열에 신규 과목 추가 \n    else aa.push({\n        id: nid,\n        data: addlist[id].data\n      }); // 현재 과목 개수가 0이면 그냥 추가 \n\n    let temp = 0;\n    let bb = [];\n\n    for (let i = 0; i < addlist.length; i++) {\n      if (addlist[i].id !== id) {\n        if (addlist[i].data.classname !== addlist[id].data.classname) {\n          if (lookschedule(addlist[i].data.classtime, addlist[id].data.classtime)) {\n            bb.push({ ...addlist[i],\n              id: temp\n            });\n            temp++;\n          }\n        }\n      }\n    }\n\n    setaddlist(bb);\n    setTdrawList(aa);\n  }; // const dispatch = useDispatch();\n\n\n  const {\n    type1,\n    type2,\n    type3\n  } = useSelector(({\n    write\n  }) => ({\n    type1: write.type1,\n    type2: write.type2,\n    type3: write.type3\n  }));\n  const Maintable = {\n    type1,\n    type2,\n    type3\n  };\n  useEffect(() => makingDrawList(), [TdrawList]);\n  useEffect(() => finalprint(), [allList]); // 배열로 시간표 리스트만 넘기면됨 \n  // 얘는 TdrawList를 살펴보고 과목당 시간을 적절히 출력할 수 있게 숫자로 바꿔줌\n\n  const makingDrawList = useCallback(() => {\n    let makingTable = [];\n\n    for (let i = 0; i < TdrawList.length; i++) {\n      // 한 과목씩 살펴봄\n      for (let j = 0; j < TdrawList[i].data.classtime.keyword.length; j++) {\n        // 한 과목의 요일수\n        let day;\n\n        switch (TdrawList[i].data.classtime.keyword[j]) {\n          case 't1':\n            day = 5;\n            break;\n\n          case 't2':\n            day = 24;\n            break;\n\n          case 't3':\n            day = 43;\n            break;\n\n          case 't4':\n            day = 62;\n            break;\n\n          case 't5':\n            day = 81;\n            break;\n\n          default:\n            break;\n        }\n\n        let dayarr = TdrawList[i].data.classtime[TdrawList[i].data.classtime.keyword[j]]; // 요일 배열\n\n        let timeleng = dayarr.length * 3.5;\n        let time = 9 + (dayarr[0] - 2) * 3.5;\n        makingTable.push({\n          x: day,\n          y: time,\n          ycolor: timeleng,\n          color: \"#CEF6F5\",\n          text: TdrawList[i].data.classname\n        });\n      }\n    }\n\n    console.log(makingTable);\n    setmakingdrawList(makingTable);\n  }, [TdrawList]); //개수기반\n  //우선순위 1개수가 같으면 일단 그거 다출력\n  // node 클래스\n  // root,일반,leaf마다 가진 요소가 다름\n  // 핵심 알고리즘\n  // 모든걸 계산함\n\n  const Calculate = () => {\n    const root1 = composeTree('type1', Maintable); // 최대개수인 리프노드들을 찾아서 maxrootlist 배열에 저장되어있음.\n    // root의 maxrootlist는 배열 -> 배열의 원소하나는  \n    // 트리를 만듬. (1순위 리스트)\n\n    let treerootlist = []; // 루트 트리들의 배열\n\n    for (let i = 0; i < root1.maxrootlist.length; i++) {\n      let treeroot = new mNode(root1.maxrootlist[i].list); // 하나의 루트트리를 만듬.\n      // root1.maxrootlist[i] 는 리프노드이고  리프노드.list에는 리프(자기)부터 루트 전까지 노드 배열이 들어가있음\n      //결국 mNode에 node리스트를 넘기는것.\n\n      treerootlist.push(treeroot); // 배열에 넣음\n      // 그다음 2순위 찾음\n\n      let root2 = composeTree('type2', Maintable, treeroot.classlist);\n\n      for (let j = 0; j < root2.maxrootlist.length; j++) {\n        treeroot.insert(root2.maxrootlist[j].list);\n        let treeroot2 = treeroot.children[j];\n        let classlist = treeroot.classlist.concat(root2.maxrootlist[j].list);\n        let root3 = composeTree('type3', Maintable, classlist); // 3순위 찾음\n\n        for (let k = 0; k < root3.maxrootlist.length; k++) {\n          treeroot2.insert(root3.maxrootlist[k].list);\n        }\n      }\n    } // for문 끝 \n    // 모든 리스트가 만들어짐.\n    // 이제 순위를 매김\n    // 1순위는 어차피 다 같을테니\n    //treerootlist에 트리가 다 들어있음\n    // 1,2,3등분으로 나눈다면\n    // 일단 1끼리 순위결정을 한다 \n    // 결정되면 다시 2내에서 순위결정\n    // 결정되면 다시 3내에서 순위결정\n    //그럼  1순위끼리는 어떻게 우선순위를 나누냐\n    // 비교함수를 만들었음 . compare(a,b)  a가크면 1 b가크면 -1 같으면 0\n    //퀵소트로 비교하면됨.\n    //1 정립 \n\n\n    for (let i = 0; i < treerootlist.length - 1; i++) {\n      for (let j = 1; j < treerootlist.length; j++) {\n        let b = compare(treerootlist[i], treerootlist[j]);\n\n        if (b === -1) {\n          let c = treerootlist[j];\n          treerootlist[j] = treerootlist[i];\n          treerootlist[i] = c;\n        }\n      }\n    } //2 정립\n\n\n    for (let i = 0; i < treerootlist.length; i++) {\n      for (let j = 0; j < treerootlist[i].children.length - 1; j++) {\n        for (let k = 1; k < treerootlist[i].children.length; k++) {\n          let b = compare(treerootlist[i].children[j], treerootlist.children[k]);\n\n          if (b === -1) {\n            let c = treerootlist[i].children[k];\n            treerootlist[i].children[k] = treerootlist[i].children[j];\n            treerootlist[i].children[j] = c;\n          }\n        }\n      }\n\n      for (let j = 0; j < treerootlist[i].children.length; j++) {\n        for (let a = 0; a < treerootlist[i].children[j].children.length - 1; a++) {\n          for (let b = 1; b < treerootlist[i].children[j].children.length; b++) {\n            let x = compare(treerootlist[i].children[j].children[a], treerootlist[i].children[j].children[b]);\n\n            if (x === -1) {\n              let y = treerootlist[i].children[j].children[b];\n              treerootlist[i].children[j].children[b] = treerootlist[i].children[j].children[a];\n              treerootlist[i].children[j].children[a] = y;\n            }\n          }\n        }\n      }\n    }\n\n    let finaldata = [];\n\n    for (let a = 0; a < treerootlist.length; a++) {\n      if (treerootlist[a].children.length === 0) {\n        finaldata.push(treerootlist[a].classlist);\n        continue;\n      }\n\n      for (let b = 0; b < treerootlist[a].children.length; b++) {\n        if (treerootlist[a].children[b].children.length === 0) {\n          finaldata.push(treerootlist[a].classlist.concat(treerootlist[a].children[b].classlist));\n          continue;\n        }\n\n        for (let c = 0; c < treerootlist[a].children[b].children.length; c++) {\n          let x = treerootlist[a].classlist.concat(treerootlist[a].children[b].classlist);\n          let y = x.concat(treerootlist[a].children[b].children[c].classlist);\n          finaldata.push(y);\n        }\n      }\n    }\n\n    setallList(finaldata);\n    return finaldata;\n  };\n\n  const finalprint = () => {\n    let kkk = [];\n\n    if (allList.length !== 0) {\n      for (let i = 0; i < allList[nownum].length; i++) {\n        let tt = allList[nownum][i];\n        tt = { ...tt,\n          id: i\n        };\n        kkk.push(tt);\n      }\n\n      setTdrawList(kkk);\n    }\n  };\n\n  const next = () => {\n    if (allList.length - 1 === nownum) {\n      setnownum(0);\n    } else {\n      setnownum(nownum + 1);\n    }\n\n    finalprint();\n  };\n\n  const previous = () => {\n    if (nownum > 0) {\n      setnownum(nownum - 1);\n      finalprint();\n    }\n  }; //TdrawList = {} 배열 []\n  // { id , n (노드)    }\n  // 1반환: a가 더큼\n  //0반환: 둘이 같음\n  //-1반환:b가 더큼\n\n\n  const compare = (a, b) => {\n    if (a.children.length === 0) {\n      if (b.children.length > 0) return -1;else return 0;\n    }\n\n    if (b.children.length === 0) {\n      if (a.children.length > 0) return 1;else return 0;\n    }\n\n    if (a.children[0].classlist[0].deep > b.children[0].classlist[0].deep) return 1;else if (a.children[0].classlist[0].deep < b.children[0].classlist[0].deep) return -1;else {\n      if (a.children.length > b.children.length) return 1;else if (a.children.length < b.children.length) return -1;else return 0;\n    }\n  };\n\n  const onCalculate = () => {\n    const root = composeTree('type1', Maintable, []);\n    let maxScoreTable = [];\n    let maxTable = [];\n\n    for (let i = 0; i < root.finalTable.length; i++) {\n      let n = root.finalTable[i];\n\n      if (n.score === root.maxScore) {\n        maxScoreTable.push(n);\n      }\n\n      if (n.deep === root.max) {\n        maxTable.push(n);\n      }\n    }\n\n    console.log('&&&&&&&&&&&&&&&학점 우선 시간표&&&&&&&&&&&&&&');\n\n    for (let i = 0; i < maxScoreTable.length; i++) {\n      let n = maxScoreTable[i];\n      let k = n.deep;\n      console.log('--------%d번째 시간표----------', i + 1);\n\n      for (let j = 0; j < k; j++) {\n        console.log('%d:%s %s %d ', j + 1, n.data.classname, n.data.profess, n.data.classscore);\n        n = n.adault;\n      }\n\n      console.log('[총 %d학점]', root.maxScore);\n      console.log('---------------------------');\n    }\n\n    console.log('&&&&&&&&&&&&&&&과목개수 우선 시간표&&&&&&&&&&&&&&');\n\n    for (let i = 0; i < maxTable.length; i++) {\n      let n = maxTable[i];\n      let a = n.score;\n      console.log('--------%d번째 시간표----------', i + 1);\n\n      for (let j = 0; j < root.max; j++) {\n        console.log('%d:%s %s %d', j + 1, n.data.classname, n.data.profess, n.data.classscore);\n        n = n.adault;\n      }\n\n      console.log('[총%d학점]', a);\n      console.log('---------------------------');\n    }\n\n    let a = maxTable[0];\n    let bb = [];\n\n    for (let i = 0; i < root.max; i++) {\n      bb.push(a.data);\n      a = a.adault;\n    }\n\n    makingDrawList(bb);\n  };\n\n  return React.createElement(Graph, {\n    onCalculate: onCalculate,\n    TdrawList: TdrawList,\n    Delete: Delete,\n    makingdrawList: makingdrawList,\n    Calculate: Calculate,\n    next: next,\n    previous: previous,\n    Add: Add,\n    addlist: addlist,\n    NextRoot: NextRoot,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 657\n    },\n    __self: this\n  });\n};\n\nexport default GraphContainer;","map":{"version":3,"sources":["C:/Users/user/Desktop/ReactProject/sugang-scheduler/sugang-frontend/src/containers/graph/GraphContainer.js"],"names":["React","useState","useCallback","useEffect","useSelector","useDispatch","withRouter","Graph","register","Node","lookschedule","insertTable","composeTree","search","tsConstructorType","mNode","constructor","list","children","classlist","insert","node","length","GraphContainer","TdrawList","setTdrawList","addlist","setaddlist","makingdrawList","setmakingdrawList","allList","setallList","nownum","setnownum","NextRoot","id","Delete","aa","filter","e","i","addtemp","addid","j","type1","data","classname","classtime","push","type2","type3","Add","nid","temp","bb","write","Maintable","makingDrawList","finalprint","makingTable","keyword","day","dayarr","timeleng","time","x","y","ycolor","color","text","console","log","Calculate","root1","treerootlist","maxrootlist","treeroot","root2","treeroot2","concat","root3","k","b","compare","c","a","finaldata","kkk","tt","next","previous","deep","onCalculate","root","maxScoreTable","maxTable","finalTable","n","score","maxScore","max","profess","classscore","adault"],"mappings":"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","sourcesContent":["\r\nimport React , {useState,useCallback,useEffect} from 'react';\r\nimport {useSelector,useDispatch} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport Graph from '../../component/graph/Graph';\r\n\r\nimport {register} from '../../modules/write';\r\n\r\nimport Node ,{lookschedule,insertTable,composeTree ,search} from '../../lib/tree/tree';\r\nimport { tsConstructorType } from '../../../../../../../AppData/Local/Microsoft/TypeScript/3.7/node_modules/@babel/types/lib/index';\r\n\r\n\r\n// 안겹친다는 가정이 필요\r\n// 안겹치고 이 함수를 사용하면 dst 시간표에 src가 추가됨. \r\n// 시간표와, 시간표에 넣을 과목을 dst, src 차례로 주면됨\r\n//const insertTable=function(dst,src)\r\n\r\nclass mNode{\r\n\r\n    children=[];\r\n    \r\n    constructor(list){\r\n\r\n        \r\n        this.classlist=list;\r\n\r\n    }\r\n \r\n    insert(list){\r\n        let node=new mNode(list);\r\n\r\n        this.children[this.children.length]=node;\r\n        \r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\nconst GraphContainer=()=>{\r\n\r\n\r\n\r\n    //TdrawList랑 addlist id는 배열의 인덱스랑 같음 \r\n    const [TdrawList,setTdrawList]=useState([]);    // 현재 신청된 목록들  (/graph 상단 목록에 영향)\r\n    //{data: , id: }\r\n    const [addlist,setaddlist]=useState([]);    // 현재 추가 가능한 목록들 (/graph 하단 목록에 영향 )\r\n    // {data: id: }\r\n\r\n    const [makingdrawList,setmakingdrawList]=useState([]); // 현재 신청된 목록의 시간표 좌표 구현\r\n\r\n    const [allList,setallList]=useState([]);    \r\n\r\n    const [nownum,setnownum]=useState(0);   \r\n\r\n    \r\n\r\n    // 대안 루트 (id)는 실패했을 경우 \r\n    const NextRoot=(id)=>{\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    };\r\n\r\n\r\n\r\n    // 현재 시간표에서 삭제 버튼 클릭시 함수 호출 \r\n    const Delete=(id)=>{\r\n\r\n       const aa=TdrawList.filter(e=>(e.id!==id));  // 일단 삭제할 id찾아서 지운배열을 aa에 전달\r\n\r\n\r\n       // id는 0부터 시작~ 시간표 개수-1만큼 \r\n       for(let i=0;i<aa.length;i++){\r\n\r\n        aa[i].id=i;\r\n\r\n       }    // id 다시 수정\r\n\r\n       setTdrawList(aa);    // 그리고 TdrawList에 적용\r\n\r\n       let addtemp=[];      // 추가가능한 과목들 배열 만듬\r\n       let addid=0;         // 추가가능한 과목의 id도 각각 부여\r\n      \r\n\r\n       // 여기서부터는 1,2,3순위 입력된 모든 과목들중에 aa에 있는 과목을 제외하고 추가로 신청 가능한 과목이 있는지 살펴봄.\r\n       for(let j=0;j<type1.length;j++){ // type1부터 살펴봄\r\n\r\n        let i=0;\r\n        for(i=0;i<aa.length;i++)    // aa는 현재 선택된 시간표 \r\n        {\r\n        if(aa[i].data.classname===type1[j].classname)   // 같은 과목은 동시 수강 못하므로 \r\n                    break;\r\n        if(!lookschedule(aa[i].data.classtime,type1[j].classtime))\r\n                break;  // 시간표가 중복되면 동시 수강 못하므로 \r\n                \r\n\r\n\r\n        }\r\n\r\n        if(i===aa.length){  // 최종적으로 수강 가능한 과목이면\r\n            addtemp.push({data:type1[j] ,id:addid});    // addtemp에 넣음.\r\n            addid++;\r\n\r\n        }\r\n\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n       \r\n        for(let j=0;j<type2.length;j++){\r\n\r\n            let i=0;\r\n            for(i=0;i<aa.length;i++)\r\n            {\r\n            if(aa[i].data.classname===type2[j].classname)\r\n                        break;\r\n            if(!lookschedule(aa[i].data.classtime,type2[j].classtime))\r\n                    break;\r\n                    \r\n    \r\n    \r\n            }\r\n    \r\n            if(i===aa.length){\r\n                addtemp.push({data:type2[j] ,id:addid});\r\n                addid++;\r\n    \r\n            }\r\n    \r\n    \r\n    \r\n            }\r\n\r\n\r\n            for(let j=0;j<type3.length;j++){\r\n\r\n                let i=0;\r\n                for(i=0;i<aa.length;i++)\r\n                {\r\n                if(aa[i].data.classname===type3[j].classname)\r\n                            break;\r\n                if(!lookschedule(aa[i].data.classtime,type3[j].classtime))\r\n                        break;\r\n                        \r\n        \r\n        \r\n                }\r\n        \r\n                if(i===aa.length){\r\n                    addtemp.push({data:type3[j] ,id:addid});\r\n                    addid++;\r\n        \r\n                }\r\n        \r\n        \r\n        \r\n                }\r\n    \r\n        setaddlist(addtemp);\r\n          \r\n      };\r\n\r\n      \r\n      const Add=(id)=>{\r\n\r\n        let nid=TdrawList.length;   // 현재 신청된 시간표의 과목 개수\r\n\r\n        let aa=[];\r\n        if(TdrawList.length!==0)    // 과목 개수가 0이 아니면\r\n             aa=[...TdrawList,{id:nid, data:addlist[id].data}]; // 기존 과목배열에 신규 과목 추가 \r\n        else\r\n            aa.push({id:nid,data:addlist[id].data});    // 현재 과목 개수가 0이면 그냥 추가 \r\n\r\n\r\n\r\n        let temp=0;\r\n        let bb=[];\r\n     \r\n      \r\n        for(let i=0;i<addlist.length;i++){\r\n            if(addlist[i].id!==id){\r\n                if(addlist[i].data.classname!==addlist[id].data.classname){\r\n                    if(lookschedule(addlist[i].data.classtime,addlist[id].data.classtime))\r\n                        {\r\n                            bb.push({...addlist[i],id:temp});\r\n                            temp++;\r\n                        }\r\n\r\n                }\r\n          \r\n            }\r\n\r\n\r\n        }\r\n      \r\n        setaddlist(bb);\r\n        setTdrawList(aa);\r\n\r\n\r\n      };\r\n    \r\n      \r\n      \r\n    \r\n\r\n    // const dispatch = useDispatch();\r\n\r\n    const {type1,type2,type3}=useSelector(({write})=>({\r\n\r\n       type1:write.type1,\r\n       type2:write.type2,\r\n       type3:write.type3,\r\n    }\r\n    )); \r\n\r\n    const Maintable={\r\n        type1,type2,type3\r\n    };\r\n    \r\n\r\n\r\nuseEffect(()=>makingDrawList(),[TdrawList]);\r\nuseEffect(()=>finalprint(),[allList]);\r\n\r\n    // 배열로 시간표 리스트만 넘기면됨 \r\n\r\n    // 얘는 TdrawList를 살펴보고 과목당 시간을 적절히 출력할 수 있게 숫자로 바꿔줌\r\n    const makingDrawList=useCallback(()=>{\r\n\r\n        let makingTable=[];\r\n\r\n        for(let i=0;i<TdrawList.length;i++){  // 한 과목씩 살펴봄\r\n\r\n            for(let j=0;j<TdrawList[i].data.classtime.keyword.length;j++){  // 한 과목의 요일수\r\n                \r\n                let day;\r\n\r\n                switch(TdrawList[i].data.classtime.keyword[j]){\r\n                    case 't1': day=5; break;\r\n                    case 't2': day=24; break;\r\n                    case 't3': day=43; break;\r\n                    case 't4': day=62; break;\r\n                    case 't5': day=81; break;\r\n                    default: break;\r\n\r\n                }\r\n\r\n              \r\n\r\n              let dayarr=  TdrawList[i].data.classtime[TdrawList[i].data.classtime.keyword[j]]; // 요일 배열\r\n                \r\n              let timeleng=dayarr.length * 3.5;\r\n              let time=9+((dayarr[0]-2)*3.5);\r\n\r\n                makingTable.push({x:day,y:time,ycolor:timeleng,color:\"#CEF6F5\",text:TdrawList[i].data.classname});\r\n            \r\n            }\r\n\r\n\r\n        }\r\n        \r\n        console.log(makingTable);\r\n        setmakingdrawList(makingTable);\r\n\r\n\r\n    },[TdrawList]);\r\n\r\n    \r\n    //개수기반\r\n    //우선순위 1개수가 같으면 일단 그거 다출력\r\n\r\n    // node 클래스\r\n    // root,일반,leaf마다 가진 요소가 다름\r\n    \r\n\r\n    // 핵심 알고리즘\r\n    // 모든걸 계산함\r\n    const Calculate=()=>{\r\n\r\n\r\n        const root1=composeTree('type1',Maintable);\r\n        \r\n        // 최대개수인 리프노드들을 찾아서 maxrootlist 배열에 저장되어있음.\r\n        // root의 maxrootlist는 배열 -> 배열의 원소하나는  \r\n     \r\n        // 트리를 만듬. (1순위 리스트)\r\n        let treerootlist=[]; // 루트 트리들의 배열\r\n\r\n        for(let i=0;i<root1.maxrootlist.length;i++){\r\n\r\n            let treeroot=new mNode(root1.maxrootlist[i].list); // 하나의 루트트리를 만듬.\r\n            // root1.maxrootlist[i] 는 리프노드이고  리프노드.list에는 리프(자기)부터 루트 전까지 노드 배열이 들어가있음\r\n            //결국 mNode에 node리스트를 넘기는것.\r\n\r\n            treerootlist.push(treeroot); // 배열에 넣음\r\n            \r\n            \r\n            // 그다음 2순위 찾음\r\n\r\n            let root2=composeTree('type2',Maintable,treeroot.classlist); \r\n            \r\n            for(let j=0;j<root2.maxrootlist.length;j++){\r\n     \r\n                treeroot.insert(root2.maxrootlist[j].list);\r\n                \r\n                let treeroot2=treeroot.children[j];\r\n                \r\n                let classlist=treeroot.classlist.concat(root2.maxrootlist[j].list);\r\n\r\n                let root3=composeTree('type3',Maintable,classlist);\r\n                \r\n\r\n                // 3순위 찾음\r\n                for(let k=0;k<root3.maxrootlist.length;k++){\r\n\r\n                    treeroot2.insert(root3.maxrootlist[k].list);\r\n\r\n                }\r\n            \r\n            \r\n            }\r\n            \r\n        }// for문 끝 \r\n       \r\n        // 모든 리스트가 만들어짐.\r\n        // 이제 순위를 매김\r\n        // 1순위는 어차피 다 같을테니\r\n        \r\n        //treerootlist에 트리가 다 들어있음\r\n        \r\n        // 1,2,3등분으로 나눈다면\r\n        // 일단 1끼리 순위결정을 한다 \r\n        // 결정되면 다시 2내에서 순위결정\r\n        // 결정되면 다시 3내에서 순위결정\r\n\r\n\r\n        //그럼  1순위끼리는 어떻게 우선순위를 나누냐\r\n        \r\n        // 비교함수를 만들었음 . compare(a,b)  a가크면 1 b가크면 -1 같으면 0\r\n\r\n        //퀵소트로 비교하면됨.\r\n\r\n        \r\n       //1 정립 \r\n\r\n        for(let i=0;i<treerootlist.length-1;i++){\r\n\r\n\r\n            for(let j=1;j<treerootlist.length;j++)\r\n            {\r\n                let b=compare(treerootlist[i],treerootlist[j])\r\n                \r\n                if(b===-1)\r\n                    {\r\n                        let c=treerootlist[j];\r\n                        treerootlist[j]=treerootlist[i];\r\n                        treerootlist[i]=c;\r\n                    \r\n                    }\r\n\r\n            }\r\n        \r\n        }\r\n\r\n        //2 정립\r\n\r\n        for(let i=0;i<treerootlist.length;i++){\r\n\r\n            for(let j=0;j<treerootlist[i].children.length-1;j++){\r\n\r\n                for(let k=1;k<treerootlist[i].children.length;k++){\r\n\r\n                    let b=compare(treerootlist[i].children[j],treerootlist.children[k]);\r\n\r\n                    if(b===-1){\r\n\r\n                        let c=treerootlist[i].children[k];\r\n                        treerootlist[i].children[k]=treerootlist[i].children[j];\r\n                        treerootlist[i].children[j]=c;\r\n                    }\r\n\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n\r\n            for(let j=0;j<treerootlist[i].children.length;j++){\r\n\r\n                for(let a=0;a<treerootlist[i].children[j].children.length-1;a++){\r\n\r\n                    for(let b=1;b<treerootlist[i].children[j].children.length;b++){\r\n\r\n                            let x=compare(treerootlist[i].children[j].children[a],treerootlist[i].children[j].children[b]);\r\n                            if(x===-1){\r\n\r\n                                let y=treerootlist[i].children[j].children[b];\r\n                                treerootlist[i].children[j].children[b]= treerootlist[i].children[j].children[a];\r\n                                treerootlist[i].children[j].children[a]=y;\r\n\r\n                            }\r\n\r\n\r\n\r\n                    }\r\n                }\r\n                \r\n            }\r\n\r\n\r\n\r\n        }\r\n                \r\n        \r\n        let finaldata=[];\r\n\r\n        for(let a=0;a<treerootlist.length;a++){\r\n\r\n                if(treerootlist[a].children.length===0){\r\n\r\n                        finaldata.push(treerootlist[a].classlist);\r\n                        continue;\r\n\r\n                }\r\n          \r\n            for(let b=0;b<treerootlist[a].children.length;b++){\r\n\r\n                    if(treerootlist[a].children[b].children.length===0){\r\n\r\n                        finaldata.push(treerootlist[a].classlist.concat(treerootlist[a].children[b].classlist));\r\n                        continue;\r\n                    }\r\n             \r\n                for(let c=0;c<treerootlist[a].children[b].children.length;c++){\r\n                        \r\n                    let x=treerootlist[a].classlist.concat(treerootlist[a].children[b].classlist);\r\n                    let y=x.concat(treerootlist[a].children[b].children[c].classlist);\r\n                    \r\n          \r\n                    finaldata.push(y);\r\n\r\n                }\r\n\r\n            }\r\n\r\n            \r\n        \r\n\r\n\r\n\r\n\r\n        }\r\n        \r\n    \r\n       \r\n        setallList(finaldata);\r\n    \r\n        return finaldata;\r\n    }\r\n\r\n    const finalprint=()=>{\r\n\r\n        let kkk=[];\r\n        if(allList.length!==0){\r\n\r\n            \r\n\r\n        for(let i=0;i<allList[nownum].length;i++){\r\n\r\n            let tt=allList[nownum][i];\r\n\r\n            tt={...tt,id:i};\r\n\r\n            kkk.push(tt);\r\n\r\n\r\n        }\r\n\r\n        setTdrawList(kkk);\r\n\r\n    }\r\n\r\n    };\r\n    \r\n\r\n    const next=()=>{\r\n\r\n        if(allList.length -1 === nownum  ){\r\n\r\n            setnownum(0);\r\n\r\n           \r\n        }\r\n\r\n        else {\r\n\r\n            setnownum(nownum+1);\r\n            \r\n\r\n        }\r\n finalprint();\r\n\r\n    };\r\n\r\n    const previous=()=>{\r\n\r\n        if(nownum>0){\r\n\r\n            setnownum(nownum-1);\r\n            finalprint();\r\n\r\n        }\r\n\r\n        \r\n\r\n    };\r\n\r\n    //TdrawList = {} 배열 []\r\n    // { id , n (노드)    }\r\n\r\n\r\n    // 1반환: a가 더큼\r\n    //0반환: 둘이 같음\r\n    //-1반환:b가 더큼\r\n    const compare=(a,b)=>{\r\n\r\n        if(a.children.length===0)\r\n        {\r\n            if(b.children.length>0)\r\n                return -1;\r\n            else\r\n                return 0;\r\n\r\n        }\r\n\r\n        if(b.children.length===0){\r\n\r\n            if(a.children.length>0)\r\n                return 1;\r\n            else    \r\n                return 0;\r\n        }\r\n\r\n        if(a.children[0].classlist[0].deep > b.children[0].classlist[0].deep)\r\n            return 1;\r\n        else if(a.children[0].classlist[0].deep < b.children[0].classlist[0].deep)\r\n            return -1;\r\n        else\r\n            {\r\n                if(a.children.length > b.children.length)\r\n                    return 1;\r\n                else if(a.children.length < b.children.length)\r\n                    return -1;\r\n                else\r\n                    return 0;\r\n\r\n\r\n            }\r\n        \r\n\r\n\r\n    };\r\n\r\n    const onCalculate=()=>{\r\n        \r\n        const root= composeTree('type1',Maintable,[]);\r\n        \r\n         \r\n         let maxScoreTable=[];\r\n         let maxTable=[];\r\n     \r\n         for(let i=0;i<root.finalTable.length;i++){\r\n     \r\n             let n=root.finalTable[i];\r\n     \r\n            if(n.score===root.maxScore){\r\n     \r\n             maxScoreTable.push(n);\r\n     \r\n     \r\n            }    \r\n     \r\n     \r\n            if(n.deep===root.max){\r\n     \r\n             maxTable.push(n);\r\n            }\r\n     \r\n         }\r\n         console.log('&&&&&&&&&&&&&&&학점 우선 시간표&&&&&&&&&&&&&&');\r\n         for(let i=0;i<maxScoreTable.length;i++){\r\n     \r\n             let n=maxScoreTable[i];\r\n             let k=n.deep;\r\n             console.log('--------%d번째 시간표----------',i+1);\r\n             for(let j=0;j<k;j++){\r\n     \r\n                 console.log('%d:%s %s %d ',j+1,n.data.classname,n.data.profess,n.data.classscore);\r\n     \r\n                 n=n.adault;\r\n             }\r\n     \r\n             console.log('[총 %d학점]',root.maxScore);\r\n             console.log('---------------------------');\r\n     \r\n         }\r\n     \r\n     \r\n         console.log('&&&&&&&&&&&&&&&과목개수 우선 시간표&&&&&&&&&&&&&&');\r\n     \r\n        for(let i=0;i<maxTable.length;i++)\r\n        {\r\n            let n=maxTable[i];\r\n            let a=n.score;\r\n            console.log('--------%d번째 시간표----------',i+1);\r\n             for(let j=0;j<root.max;j++)\r\n             {   \r\n                \r\n                 console.log('%d:%s %s %d',j+1 ,n.data.classname,n.data.profess,n.data.classscore);\r\n                 n=n.adault;\r\n     \r\n             }\r\n             console.log('[총%d학점]',a);\r\n             console.log('---------------------------');\r\n        }\r\n        \r\n        let a=maxTable[0];\r\n        let bb=[];\r\n        for(let i=0;i<root.max;i++){\r\n\r\n            bb.push(a.data);\r\n            a=a.adault;\r\n\r\n\r\n        }\r\n        makingDrawList(bb);\r\n\r\n\r\n     };\r\n\r\n     \r\n\r\n\r\n    return (\r\n        <Graph onCalculate={onCalculate}\r\n            TdrawList={TdrawList}\r\n            Delete={Delete}\r\n            makingdrawList={makingdrawList}\r\n            Calculate={Calculate}\r\n            next={next}\r\n            previous={previous}\r\n            Add={Add}\r\n            addlist={addlist}\r\n            NextRoot={NextRoot}\r\n            >\r\n\r\n            </Graph>\r\n    );\r\n\r\n\r\n};\r\n\r\n\r\nexport default GraphContainer;"]},"metadata":{},"sourceType":"module"}